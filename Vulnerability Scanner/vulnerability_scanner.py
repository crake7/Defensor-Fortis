#!/usr/bin/env python

import scanner

"""For CRAWLING:"""
target= "http://10.0.2.8/dvwa/"
links_to_ignore = ["http://10.0.2.8/dvwa/logout.php"]

#If you know the Login info:
login_dict = {"username": "admin", "password": "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target, links_to_ignore)
#POST on the current session:
target_login_url = "http://10.0.2.8/dvwa/login.php"
vuln_scanner.session.post(target_login_url, data=login_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()








"""For EXTRACTING FORMS:"""
# forms = vuln_scanner.extract_forms("http://10.0.2.8/dvwa/vulnerabilities/xss_r/")
# print(forms)
"""For SUBMITTING FORMS:"""
# response = vuln_scanner.submit_form(forms[0], "test", "http://10.0.2.8/dvwa/vulnerabilities/xss_r/")
# print(response.content)
"""For TESTING XSS in <forms>:"""
# response = vuln_scanner.test_xss_in_form(forms[0], "http://10.0.2.8/dvwa/vulnerabilities/xss_r/")
# print(response)
"""For TESTING XSS in URL:"""
# response = vuln_scanner.test_xss_in_link("http://10.0.2.8/dvwa/vulnerabilities/xss_r/?name=dfgdf#")
# print(response)
# response = vuln_scanner.test_xss_in_link("http://10.0.2.8/dvwa/vulnerabilities/fi/?page=include.php")
# print(response)